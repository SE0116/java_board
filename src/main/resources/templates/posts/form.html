<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: body}">
<body>
<section>
    <h2 th:text="${post.id} != null ? '글 수정' : '글 작성'">글 작성</h2>
    <form th:action="${post.id} != null ? @{|/posts/${post.id}|} : @{/posts}" method="post">
        <div th:if="${post.id} != null">
            <input type="hidden" name="_method" value="put"/>
        </div>
        <div>
            <label>제목</label><br/>
            <input type="text" name="title" th:value="${post.title}" maxlength="200" required/>
            <div th:if="${#fields.hasErrors('title')}" th:errors="*{title}">제목 오류</div>
        </div>
        <div>
            <label>작성자</label><br/>
            <input type="text" name="author" th:value="${post.author}" maxlength="50" required/>
            <div th:if="${#fields.hasErrors('author')}" th:errors="*{author}">작성자 오류</div>
        </div>
        <div>
            <label>내용</label><br/>
            <textarea name="content" rows="12" required
                      th:text="${post.content}">내용</textarea>
            <div th:if="${#fields.hasErrors('content')}" th:errors="*{content}">내용 오류</div>
        </div>
        <div style="margin-top:.5rem;">
            <button type="submit" th:text="${post.id} != null ? '수정' : '등록'">등록</button>
            <a th:href="@{/posts}">목록</a>
        </div>
    </form>
</section>

<script>
    // jQuery로 간단한 UX 보강 (글자수 표시 예시)
    $(function(){
      const $title = $("input[name='title']");
      const $counter = $("<small style='margin-left:.5rem;'></small>").insertAfter($title);
      function update(){ $counter.text(($title.val()||'').length + "/200"); }
      $title.on("input", update); update();
    });
</script>
</body>
</html>
