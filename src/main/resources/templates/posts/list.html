<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: body}">
<body>
<section>
    <form method="get" th:action="@{/posts}" style="margin-bottom: .6rem;">
        <input type="text" name="q" th:value="${page.q}" placeholder="검색(제목/내용/작성자)" />
        <button type="submit">검색</button>
    </form>
    <table>
        <thead>
        <tr><th>ID</th><th>제목</th><th>작성자</th><th class="right">조회</th><th>작성일</th></tr>
        </thead>
        <tbody>
        <tr th:each="p : ${posts}">
            <td th:text="${p.id}">1</td>
            <td><a th:href="@{|/posts/${p.id}|}" th:text="${p.title}">제목</a></td>
            <td th:text="${p.author}">작성자</td>
            <td class="right" th:text="${p.viewCount}">0</td>
            <td th:text="${#temporals.format(p.createdAt, 'yyyy-MM-dd HH:mm')}">-</td>
        </tr>
        <tr th:if="${#lists.isEmpty(posts)}"><td colspan="5">글이 없습니다.</td></tr>
        </tbody>
    </table>

    <div class="right" style="margin-top: .6rem;">
        <a th:href="@{/posts/new}">글쓰기</a>
    </div>

    <div style="margin-top: 1rem;">
    <span th:with="total=${total}, size=${page.size}, page=${page.page},
        last=${T(java.lang.Math).max(1, (total + size - 1) / size)}">
      <a th:each="i : ${#numbers.sequence(1, last)}"
         th:href="@{|/posts?page=${i}&size=${size}&q=${page.q}|}"
         th:text="${i}"
         th:style="${i==page} ? 'font-weight:bold; margin-right:.4rem;' : 'margin-right:.4rem;'">1</a>
    </span>
    </div>
</section>
</body>
</html>
